<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏∏‡∏î‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì‡∏†‡∏π‡∏°‡∏¥</title>
    <link rel="icon" href="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏™‡∏†‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Sarabun', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #041665 0%, #3e0972 80%);
            min-height: 100vh; padding: 20px;
        }
        .container {
            max-width: 980px; margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden; animation: slideUp 0.6s ease-out;
        }
        @keyframes slideUp { from {opacity:0; transform:translateY(30px);} to {opacity:1; transform:translateY(0);} }
        .header {
            background: linear-gradient(135deg, #040056, #041665);
            color: white; padding: 30px; text-align: center; position: relative; overflow: hidden;
        }
        .header::before{
            content:''; position:absolute; inset:0;
            background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity:.3;
        }
        .header h1 { font-size: 2.2rem; margin-bottom: 10px; position:relative; z-index:1; transition: .3s; }
        .header p { font-size: 1.1rem; opacity:.9; position:relative; z-index:1; transition:.3s; }

        /* Tabs */
        .tabs {
            display:flex; gap:10px; padding:14px 20px; background:#fff; border-bottom: 1px solid #e5e7eb;
            position: sticky; top: 0; z-index: 10;
        }
        .tab-btn {
            flex:0 0 auto; padding:10px 16px; border:2px solid #e5e7eb; border-radius:12px; background:#fff;
            font-weight:700; cursor:pointer; transition:.25s; color:#374151;
        }
        .tab-btn:hover { border-color:#9ca3af; transform: translateY(-1px); }
        .tab-btn.active { background: linear-gradient(135deg,#4f46e5,#7c3aed); color:#fff; border-color:transparent; box-shadow:0 8px 18px rgba(79,70,229,.25); }

        .section { display:none; padding: 24px 24px 36px; }
        .section.active { display:block; }

        .form-container { padding: 8px 0 0; }

        .form-group { margin-bottom: 25px; position: relative; transition: all 0.3s ease; }
        .form-group label { display:block; margin-bottom:8px; font-weight:600; color:#374151; font-size:1rem; transition:.3s; }
        .required { color:#ef4444; }
        .form-control {
            width:100%; padding:15px; border:2px solid #e5e7eb; border-radius:12px; font-size:1rem;
            transition:.3s; background:#fff;
        }
        .form-control:focus { outline:none; border-color:#4f46e5; box-shadow:0 0 0 3px rgba(79,70,229,.1); transform:translateY(-2px); }
        .form-control:hover { border-color:#9ca3af; }
        textarea.form-control { resize: vertical; min-height: 120px; }

        .priority-group { display:grid; grid-template-columns: repeat(auto-fit, minmax(120px,1fr)); gap:15px; margin-top:10px; }
        .priority-option { position:relative; }
        .priority-option input[type="radio"] { position:absolute; opacity:0; }
        .priority-label {
            display:block; padding:15px; border:2px solid #e5e7eb; border-radius:12px; text-align:center; cursor:pointer;
            transition:.25s; background:#fff; font-weight:500;
        }
        .priority-option input[type="radio"]:checked + .priority-label { border-color:#4f46e5; background:#4f46e5; color:#fff; transform:scale(1.05); }
        .priority-low{ border-color:#10b981 !important; } .priority-option input[type="radio"]:checked + .priority-low{ background:#10b981 !important; }
        .priority-medium{ border-color:#f59e0b !important; } .priority-option input[type="radio"]:checked + .priority-medium{ background:#f59e0b !important; }
        .priority-high{ border-color:#ef4444 !important; } .priority-option input[type="radio"]:checked + .priority-high{ background:#ef4444 !important; }

        .submit-btn{
            width:100%; padding:18px; background:linear-gradient(135deg,#4f46e5,#7c3aed); color:#fff; border:none; border-radius:12px;
            font-size:1.1rem; font-weight:600; cursor:pointer; transition:.3s; margin-top:20px; position:relative; overflow:hidden;
        }
        .submit-btn:hover{ transform:translateY(-2px); box-shadow:0 10px 25px rgba(79,70,229,.3); }
        .submit-btn:active{ transform:translateY(0); }
        .submit-btn::before{
            content:''; position:absolute; top:0; left:-100%; width:100%; height:100%;
            background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent); transition:left .5s;
        }
        .submit-btn:hover::before{ left:100%; }

        .success-message{
            display:none; background:linear-gradient(135deg,#10b981,#059669); color:#fff; padding:20px; border-radius:12px; margin-top:20px; text-align:center;
            animation: fadeIn .5s ease-out; transition:.3s;
        }
        @keyframes fadeIn { from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }

        .floating-elements{ position:fixed; inset:0; pointer-events:none; z-index:-1; }
        .floating-circle{ position:absolute; border-radius:50%; background:rgba(255,255,255,.1); animation:float 6s ease-in-out infinite; }
        .floating-circle:nth-child(1){ width:80px; height:80px; top:20%; left:10%; animation-delay:0s; }
        .floating-circle:nth-child(2){ width:120px; height:120px; top:60%; right:10%; animation-delay:2s; }
        .floating-circle:nth-child(3){ width:60px; height:60px; bottom:20%; left:20%; animation-delay:4s; }
        @keyframes float { 0%,100%{ transform:translateY(0);} 50%{ transform:translateY(-20px);} }

        .developer-button{
            position:fixed; bottom:20px; right:20px; background:#1e88e5; color:#fff; padding:12px 20px; border-radius:30px; text-decoration:none;
            font-size:.95rem; box-shadow:0 4px 10px rgba(0,0,0,.2); transition:.3s; z-index:1000;
        }
        .developer-button:hover{ background:#1565c0; transform:translateY(-2px); }

        /* Status (Looker) area */
        .status-tip{
            margin: -6px 0 14px; color:#374151; font-size:.95rem; opacity:.85;
        }
        .looker-wrap{
            width:100%; height:70vh; border:0; border-radius:14px; box-shadow: 0 10px 24px rgba(0,0,0,.08);
        }

        @media (max-width: 768px) {
            .container { margin: 0 10px; }
            .header h1 { font-size: 1.8rem; }
            .tabs { gap:8px; padding:12px 12px; }
            .tab-btn { padding:9px 12px; font-size:.95rem; }
            .priority-group { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Language switcher -->
    <div id="languageSwitcher" style="position: fixed; top: 20px; left: 20px; z-index: 999;">
        <select id="languageSelect" style="padding: 8px 12px; border-radius: 10px; font-weight: 600; font-family: 'Sarabun'; background: white; border: 2px solid #ccc; box-shadow: 0 2px 6px rgba(0,0,0,0.1); transition: all 0.3s ease;">
            <option value="th">  TH ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ </option>
            <option value="en">  US English </option>
        </select>
    </div>

    <!-- Decorative floating shapes -->
    <div class="floating-elements">
        <div class="floating-circle"></div>
        <div class="floating-circle"></div>
        <div class="floating-circle"></div>
    </div>

    <div style="text-align: center; margin-top: 25px;">
        <img src="‡∏û‡∏£‡∏∞‡πÄ‡∏Å‡∏µ‡πâ‡∏¢‡∏ß ‡πÅ‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ï‡∏≠‡∏û‡∏†.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" style="max-width: 200px; height: auto;">
    </div>

    <div class="container">
        <div class="header">
            <h1 id="title">‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h1>
            <p id="subtitle">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏∏‡∏î‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì‡∏†‡∏π‡∏°‡∏¥</p>
        </div>

        <!-- Tabs -->
        <nav class="tabs" role="tablist" aria-label="main navigation">
            <button id="tab-form" class="tab-btn active" role="tab" aria-selected="true" aria-controls="section-form">üìù ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</button>
            <button id="tab-status" class="tab-btn" role="tab" aria-selected="false" aria-controls="section-status">üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
        </nav>

        <!-- Section: Form -->
        <section id="section-form" class="section active" role="tabpanel" aria-labelledby="tab-form">
            <div class="form-container">
                <form id="repairForm">
                    <div class="form-group">
                        <label for="studentName" id="label-name">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="required">*</span></label>
                        <input type="text" id="studentName" class="form-control" required placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå ‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏≠‡∏≠‡∏Å‡∏ô‡∏≤‡∏°">
                    </div>

                    <div class="form-group">
                        <label for="studentId" id="label-id">‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <span class="required">*</span></label>
                        <input type="text" id="studentId" class="form-control" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 05490" pattern="[0-9]{5}" title="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 5 ‡∏´‡∏•‡∏±‡∏Å ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå 99999">
                    </div>

                    <div class="form-group">
                        <label for="location" id="label-location">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà/‡∏´‡πâ‡∏≠‡∏á <span class="required">*</span></label>
                        <input type="text" id="location" class="form-control" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 3205, ‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå, ‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥">
                    </div>

                    <div class="form-group">
                        <label for="equipment" id="label-equipment">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏° <span class="required">*</span></label>
                        <input type="text" id="equipment" class="form-control" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏•‡∏≠‡∏î‡πÑ‡∏ü, ‡∏û‡∏±‡∏î‡∏•‡∏°, ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏®">
                    </div>

                    <div class="form-group">
                        <label for="problemDescription" id="label-problem">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤ <span class="required">*</span></label>
                        <textarea id="problemDescription" class="form-control" required placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥, ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£ ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢"></textarea>
                    </div>

                    <div class="form-group">
                        <label id="label-priority">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô <span class="required">*</span></label>
                        <div class="priority-group">
                            <div class="priority-option">
                                <input type="radio" id="priorityLow" name="priority" value="‡∏ï‡πà‡∏≥" required>
                                <label for="priorityLow" class="priority-label priority-low" id="priority-low-label">
                                    üü¢ <span id="priority-low-text">‡∏ï‡πà‡∏≥</span><br>
                                    <small id="priority-low-desc">‡πÑ‡∏°‡πà‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô</small>
                                </label>
                            </div>
                            <div class="priority-option">
                                <input type="radio" id="priorityMedium" name="priority" value="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á" required>
                                <label for="priorityMedium" class="priority-label priority-medium" id="priority-medium-label">
                                    üü° <span id="priority-medium-text">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</span><br>
                                    <small id="priority-medium-desc">‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏á</small>
                                </label>
                            </div>
                            <div class="priority-option">
                                <input type="radio" id="priorityHigh" name="priority" value="‡∏™‡∏π‡∏á" required>
                                <label for="priorityHigh" class="priority-label priority-high" id="priority-high-label">
                                    üî¥ <span id="priority-high-text">‡∏™‡∏π‡∏á</span><br>
                                    <small id="priority-high-desc">‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô</small>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="contactInfo" id="label-contact">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö</label>
                        <input type="text" id="contactInfo" class="form-control" placeholder="Line ID ‡∏´‡∏£‡∏∑‡∏≠ Instagram account ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏° (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)">
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn">üì§ ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°</button>

                    <div id="successMessage" class="success-message">
                        <h3 id="successTitle">‚úÖ ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!</h3>
                        <p id="successDetail">‡∏ó‡∏≤‡∏á‡∏™‡∏†‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏∞‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ì‡∏∞‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡πá‡∏ß <br>
                        ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô: <span id="reportNumber"></span></p>
                    </div>
                </form>
            </div>
        </section>

        <!-- Section: Status (Looker Studio) -->
        <section id="section-status" class="section" role="tabpanel" aria-labelledby="tab-status">
            <p class="status-tip" id="statusTip">‡πÅ‡∏ú‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Looker Studio ‡πÅ‡∏ö‡∏ö‡∏ù‡∏±‡∏á‡∏ï‡∏±‡∏ß ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï ‚ÄúEmbed report‚Äù</p>
            <!-- ‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå embed ‡∏Ç‡∏≠‡∏á Looker Studio -->
            <iframe class="looker-wrap"
                title="‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏° (Looker Studio)"
                loading="lazy"
                allowfullscreen
                src="https://lookerstudio.google.com/embed/reporting/8d86d734-53f2-4237-ab34-fb51cc170d69">
            </iframe>
        </section>
    </div>

    <a href="developer.html" class="developer-button" id="developerBtn">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤</a>

    <script>
        // ===== Translations =====
        const translations = {
            th: {
                title: "‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå",
                subtitle: "‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏∏‡∏î‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì‡∏†‡∏π‡∏°‡∏¥",
                labelName: "‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•",
                placeholderName: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•",
                labelId: "‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô",
                placeholderId: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô",
                titleId: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 5 ‡∏´‡∏•‡∏±‡∏Å ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå 99999",
                labelLocation: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà/‡∏´‡πâ‡∏≠‡∏á",
                placeholderLocation: "‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 3205, ‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå, ‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥",
                labelEquipment: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°",
                placeholderEquipment: "‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏•‡∏≠‡∏î‡πÑ‡∏ü, ‡∏û‡∏±‡∏î‡∏•‡∏°, ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏®",
                labelProblem: "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤",
                placeholderProblem: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥, ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£ ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢",
                labelPriority: "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô",
                priorityLow: "‡∏ï‡πà‡∏≥", priorityLowDesc: "‡πÑ‡∏°‡πà‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô",
                priorityMedium: "‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á", priorityMediumDesc: "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏á",
                priorityHigh: "‡∏™‡∏π‡∏á", priorityHighDesc: "‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô",
                labelContact: "‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)",
                placeholderContact: "Line ID ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡∏ú‡πà‡∏≤‡∏ô LineOA ‡∏™‡∏†‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô",
                submitBtn: "üì§ ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°",
                submitBtnLoading: "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...",
                successTitle: "‚úÖ ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!",
                successDetail: "‡∏ó‡∏≤‡∏á‡∏™‡∏†‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏∞‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ì‡∏∞‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡πá‡∏ß <br>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô:",
                developerBtn: "‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤",
                errorMessage: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á",
                menuForm: "üìù ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°",
                menuStatus: "üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô",
                statusTip: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏° ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå"
            },
            en: {
                title: "Online Repair Request System",
                subtitle: "TRIAMUDOMSUKSA PATTHANAKARN SUVARNNABHUMI SCHOOL",
                labelName: "Full Name",
                placeholderName: "Please enter your first and last name.",
                labelId: "Student ID",
                placeholderId: "Please enter your student ID number.",
                titleId: "Please enter 5-digit student ID or type 99999 if you prefer not to disclose",
                labelLocation: "Location/Room",
                placeholderLocation: "For example: Classroom 3205, Computer Room, Restroom",
                labelEquipment: "Equipment to Repair",
                placeholderEquipment: "For example: Light bulb, Fan, Air conditioner",
                labelProblem: "Problem Description",
                placeholderProblem: "Please describe the problem found, such as malfunction, impact on you, or suspected cause of damage",
                labelPriority: "Urgency Level",
                priorityLow: "Low", priorityLowDesc: "Not urgent",
                priorityMedium: "Medium", priorityMediumDesc: "Partially usable",
                priorityHigh: "High", priorityHighDesc: "Urgent",
                labelContact: "Contact Information",
                placeholderContact: "Line ID to track repair status with LineOA TUPP SC",
                submitBtn: "üì§ Submit Repair Report",
                submitBtnLoading: "‚è≥ Submitting...",
                successTitle: "‚úÖ Report Submitted Successfully!",
                successDetail: "The student council will coordinate with administration and technician team promptly.<br>Report ID:",
                developerBtn: "About Developer",
                errorMessage: "An error occurred while submitting the data. Please try again.",
                menuForm: "üìù Form",
                menuStatus: "üìä Status",
                statusTip: "Repair report status updated in real time"
            }
        };

        // ===== Google Sheets URL =====
        const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbxbx0X973rUfd2SYlJ68CN0nTlCYuEUg2YDVb_RHEcizjX0rwzEJkSSlwDOkA_pPJsV/exec';

        let reportCounter = 1;
        let currentLanguage = 'th';
        const reportData = [];

        // ===== Date formatting (ALWAYS CE/Gregorian, Asia/Bangkok, 24h) =====
        // Use en-GB with Bangkok timezone to ensure Gregorian calendar + CE year regardless of UI language
        function formatBangkokCE(date = new Date()){
            const parts = new Intl.DateTimeFormat('en-GB', {
                timeZone: 'Asia/Bangkok',
                year: 'numeric', month: '2-digit', day: '2-digit',
                hour: '2-digit', minute: '2-digit', second: '2-digit',
                hour12: false
            }).formatToParts(date);
            const get = (t) => parts.find(p => p.type === t)?.value || '';
            return `${get('day')}/${get('month')}/${get('year')} ${get('hour')}:${get('minute')}:${get('second')}`;
        }

        // ===== Language switching =====
        function switchLanguage(lang) {
            currentLanguage = lang;
            const t = translations[lang];

            const elementsToTransition = [
                '#title', '#subtitle', '#label-name', '#label-id', '#label-location',
                '#label-equipment', '#label-problem', '#label-priority', '#label-contact',
                '#submitBtn', '#successTitle', '#successDetail', '#developerBtn',
                '#priority-low-text', '#priority-medium-text', '#priority-high-text',
                '#priority-low-desc', '#priority-medium-desc', '#priority-high-desc',
                '#tab-form', '#tab-status', '#statusTip'
            ];
            elementsToTransition.forEach(sel => { const el = document.querySelector(sel); if (el) el.style.opacity = '0'; });

            setTimeout(() => {
                document.getElementById('title').textContent = t.title;
                document.getElementById('subtitle').textContent = t.subtitle;
                document.getElementById('label-name').innerHTML = `${t.labelName} <span class="required">*</span>`;
                document.getElementById('label-id').innerHTML = `${t.labelId} <span class="required">*</span>`;
                document.getElementById('label-location').innerHTML = `${t.labelLocation} <span class="required">*</span>`;
                document.getElementById('label-equipment').innerHTML = `${t.labelEquipment} <span class="required">*</span>`;
                document.getElementById('label-problem').innerHTML = `${t.labelProblem} <span class="required">*</span>`;
                document.getElementById('label-priority').innerHTML = `${t.labelPriority} <span class="required">*</span>`;
                document.getElementById('label-contact').textContent = t.labelContact;
                document.getElementById('submitBtn').textContent = t.submitBtn;
                document.getElementById('successTitle').textContent = t.successTitle;
                document.getElementById('successDetail').innerHTML = `${t.successDetail} <span id="reportNumber"></span>`;
                document.getElementById('developerBtn').textContent = t.developerBtn;

                // placeholders
                document.getElementById('studentName').placeholder = t.placeholderName;
                document.getElementById('studentId').placeholder = t.placeholderId;
                document.getElementById('studentId').title = t.titleId;
                document.getElementById('location').placeholder = t.placeholderLocation;
                document.getElementById('equipment').placeholder = t.placeholderEquipment;
                document.getElementById('problemDescription').placeholder = t.placeholderProblem;
                document.getElementById('contactInfo').placeholder = t.placeholderContact;

                // priority labels & values
                document.getElementById('priority-low-text').textContent = t.priorityLow;
                document.getElementById('priority-medium-text').textContent = t.priorityMedium;
                document.getElementById('priority-high-text').textContent = t.priorityHigh;
                document.getElementById('priority-low-desc').textContent = t.priorityLowDesc;
                document.getElementById('priority-medium-desc').textContent = t.priorityMediumDesc;
                document.getElementById('priority-high-desc').textContent = t.priorityHighDesc;

                document.getElementById('priorityLow').value = t.priorityLow;
                document.getElementById('priorityMedium').value = t.priorityMedium;
                document.getElementById('priorityHigh').value = t.priorityHigh;

                // tabs
                document.getElementById('tab-form').textContent = t.menuForm;
                document.getElementById('tab-status').textContent = t.menuStatus;
                document.getElementById('statusTip').textContent = t.statusTip;

                elementsToTransition.forEach(sel => { const el = document.querySelector(sel); if (el) el.style.opacity = '1'; });
            }, 200);
        }

        document.getElementById('languageSelect').addEventListener('change', function(){
            switchLanguage(this.value);
        });

        // ===== Tabs behavior =====
        const tabForm = document.getElementById('tab-form');
        const tabStatus = document.getElementById('tab-status');
        const sectionForm = document.getElementById('section-form');
        const sectionStatus = document.getElementById('section-status');

        function setActiveTab(which){
            const isForm = which === 'form';
            tabForm.classList.toggle('active', isForm);
            tabStatus.classList.toggle('active', !isForm);
            tabForm.setAttribute('aria-selected', isForm ? 'true' : 'false');
            tabStatus.setAttribute('aria-selected', !isForm ? 'true' : 'false');
            sectionForm.classList.toggle('active', isForm);
            sectionStatus.classList.toggle('active', !isForm);
        }

        tabForm.addEventListener('click', () => setActiveTab('form'));
        tabStatus.addEventListener('click', () => setActiveTab('status'));

        // ===== Send to Google Sheets =====
        async function sendToGoogleSheets(data) {
            try {
                await fetch(GOOGLE_SHEETS_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                return true; // no-cors: assume success
            } catch (error) {
                console.error('Error sending to Google Sheets:', error);
                return false;
            }
        }

        // ===== Form submission =====
        document.getElementById('repairForm').addEventListener('submit', async function(e){
            e.preventDefault();
            const t = translations[currentLanguage];

            // loading state
            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = t.submitBtnLoading;
            submitBtn.disabled = true;

            const formData = {
                reportId: 'RPT' + new Date().getFullYear() + String(reportCounter).padStart(4, '0'),
                studentName: document.getElementById('studentName').value,
                studentId: document.getElementById('studentId').value,
                location: document.getElementById('location').value,
                equipment: document.getElementById('equipment').value,
                problemDescription: document.getElementById('problemDescription').value,
                priority: document.querySelector('input[name="priority"]:checked').value,
                contactInfo: document.getElementById('contactInfo').value || (currentLanguage === 'th' ? '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏' : 'Not specified'),

                // ALWAYS CE (Gregorian) ‚Äî e.g., 18/08/2025 20:31:05
                timestamp: formatBangkokCE(new Date()),

                // extra machine-friendly field (optional, CE ISO)
                timestampISO: new Date().toISOString(),

                language: currentLanguage
            };

            const success = await sendToGoogleSheets(formData);

            if (success) {
                reportData.push(formData);
                document.getElementById('reportNumber').textContent = formData.reportId;
                document.getElementById('successMessage').style.display = 'block';
                document.getElementById('successMessage').scrollIntoView({ behavior: 'smooth', block: 'center' });
                this.reset();
                reportCounter++;
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            } else {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
                alert(t.errorMessage);
            }
        });

        // ===== Init =====
        document.addEventListener('DOMContentLoaded', () => {
            switchLanguage(document.getElementById('languageSelect').value);
            setActiveTab('form'); // default tab
        });
    </script>
</body>
</html>
